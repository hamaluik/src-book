# src-book

Convert source code repositories into printable PDF books.

Archive your software the old-fashioned way by turning your codebase into a formatted book with syntax highlighting, table of contents, and commit history.

## Features

- Extracts files from git repositories (respects `.gitignore`)
- Syntax highlighting with configurable themes
- Generated PDF includes:
  - Title page with authors
  - Table of contents with clickable links
  - Syntax-highlighted source files
  - Embedded images (PNG, JPG, SVG, etc.)
  - Commit history
  - PDF bookmarks for navigation
- Configurable page dimensions, margins, and fonts

## Installation

```bash
cargo install --path .
```

Or build from source:

```bash
cargo build --release
```

## Usage

### 1. Create a configuration file

Run the interactive configuration wizard:

```bash
src-book config
```

This will prompt you for:
- Book title
- Repository path
- File globs to exclude
- Authors
- Licenses
- Output PDF settings

The wizard creates a `src-book.toml` configuration file.

### 2. Render the PDF

```bash
src-book render
```

This reads `src-book.toml` and generates the PDF.

## Configuration

Example `src-book.toml`:

```toml
[source]
title = "My Project"
repository = "."
licenses = ["MIT"]
entrypoint = "src/main.rs"  # optional: controls file ordering

[[source.authors]]
identifier = "Jane Doe <jane@example.com>"

[pdf]
outfile = "my-project.pdf"
theme = "GitHub"
font = "SourceCodePro"

# Page dimensions (in inches)
page_width_in = 5.5
page_height_in = 8.5

# Asymmetric margins for booklet printing (in inches)
margin_top_in = 0.5
margin_bottom_in = 0.25
margin_inner_in = 0.25   # gutter side, bound edge
margin_outer_in = 0.125  # outer edge

# Font sizes (in points) - all optional with sensible defaults
font_size_title_pt = 32.0
font_size_heading_pt = 24.0
font_size_subheading_pt = 12.0
font_size_body_pt = 10.0
font_size_small_pt = 8.0
```

### Source Options

| Option | Description |
|--------|-------------|
| `title` | Book title displayed on the title page |
| `repository` | Path to the git repository |
| `licenses` | SPDX license identifiers |
| `entrypoint` | Optional file path that will appear first; files in its directory are prioritized |
| `source_files` | Explicit list of files to include (auto-generated by config wizard) |

### PDF Options

| Option | Default | Description |
|--------|---------|-------------|
| `font` | `SourceCodePro` | Font family name or path |
| `theme` | `GitHub` | Syntax highlighting theme |
| `page_width_in` | `5.5` | Page width in inches |
| `page_height_in` | `8.5` | Page height in inches |
| `margin_top_in` | `0.5` | Top margin |
| `margin_bottom_in` | `0.25` | Bottom margin |
| `margin_inner_in` | `0.25` | Inner (gutter) margin for binding |
| `margin_outer_in` | `0.125` | Outer margin |
| `font_size_*_pt` | varies | Font sizes for different text elements |

### Available Syntax Themes

- `Solarized (light)`
- `OneHalfLight`
- `gruvbox (Light) (Hard)`
- `GitHub`

### Fonts

Two monospace fonts are bundled:

- `SourceCodePro` (default) - includes Regular, Bold, Italic, and BoldItalic variants
- `FiraMono` - includes Regular and Bold (falls back to regular for italic styles)

#### Using Custom Fonts

You can use your own fonts by placing `.ttf` files next to `src-book.toml` and setting the font path:

```toml
[pdf]
font = "./MyFont"
```

The tool will look for files matching these patterns:
- `MyFont-Regular.ttf` (required)
- `MyFont-Bold.ttf` (optional, falls back to Regular)
- `MyFont-Italic.ttf` or `MyFont-It.ttf` (optional)
- `MyFont-BoldItalic.ttf` or `MyFont-BoldIt.ttf` (optional)

### Font Sizes

Font sizes can be individually configured, or the config wizard will calculate them from a base size:

| Size | Default | Used for |
|------|---------|----------|
| `font_size_title_pt` | 32 | Title page heading |
| `font_size_heading_pt` | 24 | Section headings (e.g., "Contents") |
| `font_size_subheading_pt` | 12 | File path headers on each page |
| `font_size_body_pt` | 10 | Source code text |
| `font_size_small_pt` | 8 | Line numbers, page numbers, metadata |

The config wizard calculates these from a base size using ratios: title = 3.2×, heading = 2.4×, subheading = 1.2×, body = 1×, small = 0.8×.

### Entrypoint and File Ordering

When you specify an `entrypoint` (e.g., `src/main.rs`), files are sorted with:
1. The entrypoint file first
2. Other files in the entrypoint's directory
3. Subdirectories of the entrypoint's directory
4. Everything else alphabetically

This ordering helps readers start with the main entry point and naturally flow through related code.

## Requirements

- Rust 1.70+
- The target repository must be a git repository

## License

See repository for license information.
